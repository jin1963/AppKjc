<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Approve KJC</title>
  <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
  <script src="erc20Abi.js"></script> <!-- ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ -->
</head>
<body>
  <h2>üéØ ‡∏£‡∏∞‡∏ö‡∏ö Approve KJC Token</h2>

  <button onclick="connectWallet()">üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤</button>
  <p id="walletAddress">‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤</p>

  <button onclick="approveKJC()">‚úÖ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ KJC ‡πÉ‡∏´‡πâ Smart Contract</button>

  <script>
    const kjcAddress = "0xd479Ae350Dc24168E8dB863c5413C35fb2044ecD";
    const spenderAddress = "0xBaeF58FC0Eb20334b2fDEC4882e2AB972C1242DE";
    const approveAmount = "1000000000000000000000000"; // 1,000,000 KJC

    let web3;
    let user;
    let kjcToken;

    async function connectWallet() {
      if (window.ethereum || window.bitkeep?.ethereum) {
        window.web3 = new Web3(window.ethereum || window.bitkeep.ethereum);
        const accounts = await web3.eth.requestAccounts();
        user = accounts[0];
        kjcToken = new web3.eth.Contract(erc20ABI, kjcAddress);
        document.getElementById("walletAddress").innerText = "‚úÖ " + user;
      } else {
        alert("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á MetaMask ‡∏´‡∏£‡∏∑‡∏≠ Bitget Wallet");
      }
    }

    async function approveKJC() {
      if (!web3 || !user || !kjcToken) {
        alert("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏Å‡πà‡∏≠‡∏ô");
        return;
      }

      try {
        await kjcToken.methods.approve(spenderAddress, approveAmount).send({ from: user });
        alert("‚úÖ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!");
      } catch (error) {
        console.error(error);
        alert("‚ùå ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
      }
    }
  </script>
</body>
</html>
